% input: a file name
% output: feature matrix, each row is a frame


function [Img, f_file] = File2Feature(fileName, classLabel, ifScaled, featureClass, feature_min, scalingFactors, fftimage)

thr_sqr_matlab_log = 17;%14.14 17 %25->122, 30->385, 20->38.5(39), 14.14->10, 15->12, 10->3.85(4), 17->19.3 18->24.3 19->30.6 16->15.3
%14.14->10, 14.14 is chosen in matlab, 10 in c#
thr_sqr_matlab = 10^(thr_sqr_matlab_log/10)*25238; % because S^2/P = 25238
% thr_sqr_matlab = 0.5e4; %1.4568e+04;
thr_sqr_Csharp = thr_sqr_matlab/(256^2);


thr_sqr_Csharp = 10;
thr_sqr_matlab = thr_sqr_Csharp * 256^2;
thr_sqr_matlab_log = log10(thr_sqr_matlab/25238)*10;

thr_sqr_matlab_log = 10;
%14.14->10, 14.14 is chosen in matlab, 10 in c#
thr_sqr_matlab = 10^(thr_sqr_matlab_log/10)*25238; % because S^2/P = 25238
% thr_sqr_matlab = 0.5e4; %1.4568e+04;
thr_sqr_Csharp = thr_sqr_matlab/(256^2);




%%%  uncomment while test one existing file %%%%%%%%%%%%%%
% path_data='C:\Users\he\My Research\2015.1\20150203-arc\cut';
% fileName='1_cut1';
% % path_data='C:\Users\he\My Research\2015.1\20150210-arc';
% % fileName='balltest_old_lowtable';
% % path_data='C:\Users\he\My Research\2015.1\20150203-arc';
% % fileName='1'
%
%
% cd(path_data);
% classLabel = 'human';
% ifScaled = 0;
% featureClass = 0;
% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



[I,Q,N]=Data2IQ(ReadBin([fileName,'.data']));  %Extracting I and Q component from data

%% Test from array - copy from WriteDataToNor.cs, uncomment if use the csharp stored dummy data
% I=[2028, 2002, 2040, 2068, 2045, 1988, 1999, 2000, 2023, 2009, 2029, 2072, 2057, 2048, 2076, 2131, 2064, 2010, 2042, 2061, 2069, 2074, 2026, 2028, 2077, 2086, 2082, 2030, 2010, 2062, 2117, 2060, 2016, 1992, 2063, 2121, 2069, 1966, 1975, 2099, 2150, 2082, 1992, 2000, 2065, 2146, 2089, 2015, 1980, 2087, 2157, 2125, 2022, 1980, 2030, 2128, 2128, 1981, 1933, 2071, 2245, 2214, 2043, 1950, 2001, 2075, 2043, 1960, 1977, 2086, 2133, 2067, 1981, 2010, 2145, 2146, 2029, 1887, 1960, 2109, 2153, 2045, 1974, 2001, 2094, 2100, 2019, 1957, 2026, 2129, 2081, 1985, 2021, 2132, 2144, 1996, 1949, 2052, 2126, 2056, 1973, 2054, 2133, 2093, 2032, 2036, 2118, 2121, 2023, 1993, 2083, 2127, 2019, 1992, 2078, 2126, 2048, 1997, 2054, 2104, 2041, 2011, 2077, 2075, 2055, 2062, 2097, 2035, 1995, 2068, 2104, 2035, 2019, 2088, 2120, 2074, 2019, 2030, 2100, 2141, 2070, 2041, 2147, 2138, 2056, 1974, 1910, 2007, 2224, 2100, 1839, 1969, 2187, 2158, 2053, 1929, 1934, 2085, 2180, 2067, 1949, 2011, 2125, 2119, 1988, 1857, 1927, 2174, 2184, 2038, 1942, 2021, 2152, 2200, 2061, 1926, 1926, 2057, 2176, 2080, 2005, 2106, 2264, 2358, 2257, 2062, 1953, 1962, 2038, 2072, 2005, 1932, 1993, 2062, 2055, 1975, 1889, 1913, 2006, 2098, 2107, 2002, 2021, 2140, 2179, 2094, 1970, 2023, 2118, 2098, 1992, 1915, 1994, 2115, 2142, 1988, 1958, 2039, 2096, 2073, 1925, 1933, 2017, 2125, 2092, 1987, 1958, 2064, 2138, 2064, 1938, 1950, 2079, 2117, 2003, 1918, 2012, 2108, 2080, 1946, 1957, 2101, 2119, 1996, 1911, 2021, 2132, 2050, 1947, 2026, 2146, 2081, 1976, 2020, 2144, 2094, 1959, 2009, 2144, 2064, 1949, 2046, 2169, 2069, 1957, 2071, 2191, 2004, 1892, 2090, 2179, 1997, 1950, 2159, 2253, 2089, 1908, 1889, 2119, 2279, 1967, 1775, 2124, 2318, 2148, 2018, 1982, 2123, 2342, 2206, 1940, 1949, 2042, 2248, 2218, 1903, 1935, 2092, 2221, 2197, 2009, 1951, 2041, 2122, 2142, 2063, 1999, 2061, 2084, 2043, 1990, 2009, 2093, 2193, 2218, 2228, 2112, 1904, 1739, 1729, 1784, 1812, 1845, 1972, 2071, 2163, 2125, 1989, 1943, 2032, 2114, 2153, 2125, 2009, 1933, 1968, 2103, 2181, 2075, 2074, 2181, 2236, 2097, 2007, 2077, 2184, 2212, 2071, 2058, 2067, 2097, 2080, 2123, 2167, 2148, 2057, 1990, 2072, 2143, 2084, 1982, 2009, 2127, 2118, 1980, 1941, 2069, 2211, 2091, 1902, 1953, 2161, 2149, 1920, 1924, 2168, 2198, 1944, 1881, 2152, 2221, 1972, 1916, 2172, 2217, 1942, 1909, 2165, 2139, 1928, 2000, 2202, 2082, 1955, 2078, 2061, 1972, 2068, 2156, 2167, 2093, 2038, 2007, 2014, 2085, 2135, 2091, 2079, 2104, 2128, 2067, 2024, 1885, 1937, 2162, 2123, 2054, 2095, 2012, 1955, 2303, 2100, 1796, 2048, 2154, 2406, 2312, 1802, 1873, 2015, 2157, 2432, 2072, 1843, 2020, 2264, 2414, 2064, 1707, 1821, 2152, 2404, 2281, 2004, 2030, 2323, 2362, 2004, 1503, 1413, 1768, 1982, 1946, 1895, 1869, 2003, 2164, 2237, 2246, 2206, 2141, 2108, 2163, 2280, 2274, 1995, 1910, 2021, 2313, 2349, 2077, 1775, 1830, 2096, 2226, 2039, 1741, 1753, 1991, 2251, 2044, 1739, 1764, 2095, 2161, 1937, 1739, 1862, 2196, 2163, 1829, 1694, 2013, 2275, 2041, 1679, 1766, 2212, 2304, 1904, 1670, 1949, 2375, 2249, 1783, 1745, 2178, 2354, 1974, 1788, 2127, 2414, 2118, 1794, 1945, 2250, 2148, 1821, 1867, 2127, 2143, 1890, 1880, 2153, 2116, 1893, 1964, 2221, 2216, 2046, 1916, 2091, 2225, 2088, 2067, 2099, 2001, 1947, 2137, 2239, 2037, 1893, 2143, 2283, 1988, 1753, 1956, 2334, 2301, 1983, 1737, 2069, 2321, 2143, 2088, 2093, 2117, 2358, 2228, 1753, 1836, 2201, 2200, 2255, 1908, 1749, 1975, 1972, 2313, 1994, 1718, 1816, 2189, 2298, 2060, 1992, 1944, 2084, 2255, 2142, 1810, 1634, 1821, 2075, 1915, 1725, 1735, 1851, 1922, 1966, 1889, 1832, 1926, 2201, 2352, 2433, 2333, 2320, 2362, 2268, 2127, 2035, 2185, 2342, 2117, 1649, 1453, 1725, 2197, 2294, 2074, 1993, 2150, 2330, 2269, 2117, 2019, 2078, 2110, 1990, 1883, 2084, 2389, 2321, 1887, 1693, 2054, 2429, 2257, 1885, 1768, 2103, 2369, 2154, 1815, 1904, 2322, 2325, 1853, 1796, 2239, 2385, 1942, 1712, 2052, 2341, 2056, 1757, 2025, 2327, 2123, 1822, 1978, 2281, 2130, 1941, 2096, 2203, 1946, 1848, 2225, 2253, 1774, 1828, 2257, 2118, 1730, 1891, 2382, 2265, 1724, 1849, 2207, 2052, 1665, 1932, 2451, 2185, 1569, 1815, 2511, 2367, 2017, 1989, 1786, 1906, 2318, 2061, 1644, 1881, 2152, 2349, 2174, 1766, 1706, 1856, 2394, 2260, 1626, 1538, 1886, 2489, 2347, 1753, 1622, 1739, 2288, 2449, 2038, 1596, 1884, 2436, 2666, 2184, 1536, 1533, 2118, 2599, 2435, 1815, 1758, 2163, 2739, 2800, 2338, 2015, 2111, 2354, 2274, 1912, 1549, 1731, 2347, 2753, 2476, 1978, 1799, 2086, 2314, 2038, 1745, 1913, 2383, 2527, 2087, 1578, 1713, 2249, 2183, 1864, 1781, 1881, 2101, 2077, 1879, 1934, 2175, 2274, 2055, 1905, 2035, 2247, 2172, 1969, 1921, 2167, 2299, 2064, 1835, 1989, 2235, 2117, 1826, 1817, 2074, 2154, 1921, 1793, 1971, 2091, 1913, 1782, 1985, 2205, 2068, 1915, 2126, 2358, 2205, 1978, 2096, 2255, 1996, 1837, 2050, 2167, 1974, 1973, 2260, 2251, 1898, 1901, 2210, 2208, 1950, 1886, 2074, 2233, 2016, 1964, 2014, 2012, 2033, 2226, 2220, 2024, 2210, 2174, 1955, 2125, 2239, 2100, 2136, 2247, 2137, 2308, 2295, 2173, 2313, 2114, 1962, 2003, 1914, 1852, 1966, 1887, 1913, 1846, 1781, 1855, 1918, 2031, 1854, 1794, 2072, 2596, 2525, 1982, 1736, 1893, 2113, 2025, 1756, 1684, 1941, 2344, 2521, 2384, 2094, 1977, 2159, 2358, 2153, 1833, 1818, 2079, 2182, 2113, 2004, 2017, 2157, 2240, 2134, 1943, 1944, 2156, 2245, 2032, 1784, 1920, 2359, 2431, 2132, 1946, 1990, 2255, 2203, 1952, 1919, 2080, 2109, 1957, 2003, 2288, 2350, 2037, 1761, 1960, 2296, 2234, 1860, 1786, 2113, 2328, 2066, 1814, 2055, 2326, 2048, 1672, 1872, 2376, 2313, 1733, 1681, 2276, 2379, 1760, 1635, 2233, 2356, 1780, 1669, 2255, 2351, 1778, 1705, 2209, 2234, 1789, 1793, 2212, 2173, 1781, 1861, 2128, 2077, 1805, 1898, 2217, 2156, 1916, 1914, 1990, 1919, 1972, 2157, 2075, 1981, 2048, 2018, 1900, 1970, 2056, 2022, 1834, 1883, 2244, 2338, 2390, 2251, 1837, 1812, 2208, 2258, 2029, 1783, 1723, 2168, 2340, 2090, 1803, 1744, 2012, 2203, 2088, 2139, 1996, 2014, 2241, 2205, 2192, 1999, 1808, 1972, 2162, 2073, 1961, 1937, 2057, 2215, 2248, 2156, 2031, 1955, 1902, 1901, 1803, 1684, 1666, 1861, 2173, 2288, 2154, 1997, 2022, 2090, 2043, 2001, 2070, 2215, 2195, 2011, 1924, 2003, 2043, 1972, 2042, 2077, 2132, 2085, 2121, 2076, 2049, 2100, 2141, 2148, 2063, 1960, 1923, 1997, 2119, 2125, 2072, 2020, 2008, 1988, 1975, 1963, 1966, 2042, 2052, 2085, 2062, 2061, 2051, 2089, 2115, 2104, 2058, 2064, 2129, 2145, 2035, 1945, 2029, 2085, 2035, 1947, 1969, 2047, 2014, 1943, 1981, 2133, 2131, 1991, 1972, 2085, 2110, 2084, 2077, 2135, 2046, 1990, 2046, 2080, 1973, 1993, 2098, 2190, 2186, 1971, 1906, 2123, 2245, 2124, 2040, 1949, 2029, 2152, 2147, 2009, 1884, 2014, 2189, 2226, 2114, 1979, 2139, 2155, 2304, 2200, 2009, 1919, 2076, 2251, 2143, 2083, 2021, 1990, 2032, 2001, 1972, 1973, 2009, 2144, 2253, 2126, 2027, 1957, 1957, 2028, 2033, 1994, 2033, 2098, 2158, 2127, 2083, 2023, 2020, 2132, 2224, 2148, 1901, 1713, 1812, 1955, 2053, 2002, 1913, 1962, 2046, 2010, 1985, 1992, 2095, 2196, 2082, 1905, 1854, 2010, 2171, 2161, 2052, 1992, 2058, 2128, 2061, 1977, 2022, 2092, 2130, 2099, 2096, 2138, 2139, 2017, 1936, 1988, 2098, 2079, 1995, 1966, 1993, 2018, 1999, 1977, 2056, 2107, 2080, 1993, 1989, 2058, 2097, 2066, 2045, 2062, 2058, 2027, 2008, 2039, 2067, 2034, 2019, 2062, 2129, 2060, 2054, 2078, 2093, 2087, 2053, 2053, 2065, 2043, 2103, 2092, 2061, 2046, 2025, 2042, 2078, 2075, 2075, 2056, 2069, 2070, 2039, 2037, 2060, 2057, 2084, 2069, 2058, 2047, 1981, 2006, 2046, 2034, 2014, 2020, 2022, 2091, 2051, 2028, 2007, 1987, 1993, 2024, 2012, 2035, 2052, 2077, 2067, 2072, 2044, 2039, 2047, 2053, 2125, 2101, 2060, 2063, 2042, 2038, 2073, 2091, 2110, 2146, 2158, 2131, 2097, 2094, 2089, 2073, 2042, 2030, 2035, 2083, 2138, 2170, 2177, 2133, 2097, 2106, 2111, 2128, 2112, 2092, 2061, 2089, 2108, 2131, 2103, 2106, 2107, 2099, 2077, 2055, 2070, 2098, 2083, 2062, 2037, 1981, 2021, 2041, 2027, 2005, 2011, 2012, 2018, 2016, 2009, 1983, 2006, 2055, 2083, 2082, 2031, 1988, 2026, 2058, 2057, 2034, 2022, 2059, 2100, 2077, 2095, 2101, 2123, 2139, 2101, 2073, 2088, 2108, 2092, 2083, 2073, 2065, 2076, 2075, 2082, 2082, 2071, 2111, 2084, 2062, 2066, 2049, 2053, 2081, 2082, 2093, 2090, 2087, 2121, 2136, 2133, 2133, 2114, 2066, 2080, 2102, 2078, 2100, 2081, 2055, 2040, 2036, 2044, 2025, 1999, 1996, 2020, 2030, 2063, 2022, 2025, 2026, 2008, 1998, 1976, 2005, 2038, 2051, 2045, 2028, 2024, 2016, 1988, 1982, 1995, 1988, 1994, 2033, 2044, 2042, 2038, 1988, 1975, 2010, 2041, 2023, 2014, 1994, 1999, 2012, 2051, 2051, 2038, 2039, 2036, 2035, 2029, 2013, 1973, 1966, 1998, 2035, 2063, 2051, 2042, 2031, 2009, 2007, 2003, 2039, 2048, 2040, 2012, 2008, 1987, 1957, 1965, 1999, 2022, 2018, 2055, 2012, 1999, 2059, 2120, 2110, 2086, 2068, 2095, 2110, 2123, 2138, 2082, 2054, 2063, 2071, 2081, 2065, 2059, 2079, 2115, 2100, 2067, 2078, 2091, 2062, 2075, 2106, 2130, 2144, 2155, 2118, 2052, 2024, 2089, 2155, 2165, 2107, 2130, 2171, 2168, 2114, 2048, 2044, 2061, 2091, 2064, 2035, 2067, 2050, 1976, 1922, 1917, 1953, 1983, 2013, 2020, 2028, 2032, 2023, 1964, 2073, 2094, 2066, 2056, 2080, 2049, 1964, 1952, 1979, 1995, 2033, 2110, 2132, 2055, 2046, 2093, 2069, 2057, 2042, 2021, 2015, 2074, 2065, 2062, 2090, 2097, 2130, 2108, 2061, 2062, 2085, 2071, 2040, 2101, 2138, 2086, 2086, 2111, 2135, 2093, 2065, 2073, 2063, 2052, 2063, 2076, 2055, 1997, 1955, 1944, 2002, 2034, 2072, 2060, 2045, 2022, 1964, 1960, 1948, 1941, 1924, 1967, 2005, 1999, 2025, 2078, 2136, 2141, 2129, 2114, 2103, 2069, 2051, 2045, 2046, 2023, 2029, 2034, 2015, 2048, 2068, 2052, 2059, 2051, 2002, 1938, 1963, 1970, 1978, 1963, 1980, 2034, 2058, 2058, 2018, 2036, 2049, 2063, 2062, 1974, 1886, 1883, 2003, 2109, 2153, 2097, 1999, 1966, 1970, 2008, 2064, 2094, 2113, 2076, 2006, 1916, 1876, 1895, 1994, 2128, 2192, 2190, 2192, 2141, 2091, 2075, 2050, 2064, 2045, 2046, 2012, 1990, 2022, 2081, 2157, 2142, 2086, 1953, 1933, 2035, 2129, 2152, 2114, 2093, 2105, 2127, 2112, 2112, 2110, 2116, 2111, 2105, 2075, 2031, 2028, 2067, 2071, 2058, 2042, 2039, 2042, 2058, 2083, 2040, 2029, 2070, 2129, 2140, 2137, 2125, 2095, 2094, 2079, 2083, 2137, 2157, 2169, 2204, 2204, 2180, 2186, 2178, 2140, 2102, 2113, 2111, 2133, 2135, 2147, 2142, 2127, 2120, 2162, 2145, 2158, 2158, 2141, 2135, 2133, 2122, 2108, 2102, 2107, 2095, 2073, 2053, 2024, 1978, 1942, 1929, 1878, 1855, 1851, 1871, 1904, 1919, 1939, 1962, 1985, 2006, 2000, 1992, 2003, 2042, 2040, 1999, 2013, 2037, 2042, 2035, 2055, 2035, 2036, 2043, 2043, 2073];
% Q=[2067, 2100, 2081, 2031, 2064, 2106, 2097, 2055, 2084, 2121, 2078, 2036, 2005, 2049, 2043, 1984, 2063, 2131, 2109, 2046, 2067, 2062, 2144, 2166, 2102, 2043, 2022, 2076, 2162, 2096, 1994, 2013, 2086, 2116, 2036, 1964, 2036, 2158, 2168, 2053, 1962, 2025, 2113, 2152, 2103, 1983, 1942, 2036, 2130, 2086, 1939, 1885, 2020, 2141, 2091, 1960, 1949, 2103, 2234, 2134, 1909, 1830, 2010, 2194, 2153, 2051, 2037, 2129, 2154, 2074, 1994, 2029, 2162, 2153, 1996, 1908, 2035, 2183, 2190, 2036, 1933, 2015, 2133, 2150, 1966, 1985, 2061, 2159, 2127, 2011, 2011, 2130, 2118, 1977, 1893, 2074, 2174, 2075, 1954, 2026, 2167, 2086, 1944, 1957, 2097, 2107, 1992, 1963, 2097, 2142, 2017, 1924, 2056, 2127, 2040, 1951, 2040, 2102, 2052, 1992, 2007, 2074, 2072, 2036, 2068, 2058, 2020, 2096, 2112, 2045, 1965, 2044, 2059, 2007, 1975, 2009, 2104, 2101, 2007, 1944, 2019, 2048, 1945, 1921, 2014, 2107, 2205, 2164, 1886, 1930, 2275, 2225, 1912, 1889, 1995, 2149, 2197, 2063, 1922, 1998, 2148, 2122, 2002, 1974, 2051, 2240, 2246, 1985, 1895, 2071, 2200, 2121, 1983, 1866, 1979, 2116, 2228, 2137, 1994, 2030, 2175, 2131, 1900, 1724, 1824, 2003, 2148, 2157, 2026, 1969, 2066, 2190, 2174, 2075, 1984, 2089, 2209, 2253, 2174, 2036, 2010, 2082, 2041, 1963, 1922, 1979, 2106, 2079, 1959, 1878, 2090, 2268, 2223, 2058, 1971, 2050, 2173, 2059, 1984, 1975, 2153, 2209, 2099, 1940, 1957, 2096, 2161, 2089, 1982, 1989, 2144, 2182, 2033, 1943, 2074, 2214, 2168, 1983, 1976, 2147, 2184, 2026, 1933, 2056, 2190, 2089, 1936, 2017, 2155, 2104, 1956, 1954, 2110, 2067, 1921, 1984, 2176, 2138, 1952, 2003, 2218, 2139, 1945, 1981, 2175, 2086, 1911, 2037, 2213, 2079, 1928, 2109, 2253, 2031, 1855, 1932, 2191, 2284, 2046, 1808, 2077, 2427, 2065, 1729, 1900, 2095, 2186, 2071, 1755, 1743, 2121, 2241, 2188, 1931, 1804, 2182, 2255, 2090, 1942, 1853, 2002, 2155, 2087, 1977, 1954, 2027, 2084, 2054, 2001, 2056, 2087, 2135, 2038, 1886, 1835, 1747, 1839, 2086, 2294, 2367, 2350, 2358, 2357, 2255, 2162, 1997, 1977, 2108, 2174, 2127, 1986, 1910, 1917, 2001, 2149, 2165, 1972, 1881, 2018, 2088, 1937, 1819, 1918, 2081, 2079, 1942, 1847, 1988, 2055, 2018, 2002, 2007, 1992, 1891, 1911, 1989, 2075, 1995, 1885, 1989, 2084, 2087, 1962, 1949, 2086, 2213, 2092, 1898, 1990, 2261, 2234, 1962, 1903, 2182, 2247, 1992, 1866, 2121, 2282, 2006, 1847, 2139, 2276, 1982, 1855, 2152, 2258, 1936, 1911, 2228, 2216, 1940, 2006, 2159, 2008, 2008, 2139, 2096, 1977, 1937, 2028, 2102, 2114, 2124, 2067, 1978, 1996, 2057, 2018, 1974, 2015, 2022, 2233, 2289, 1990, 1967, 2065, 2025, 2125, 2237, 1795, 1882, 2356, 2137, 2011, 1775, 1699, 2288, 2319, 2107, 2003, 1585, 1932, 2344, 2184, 1882, 1654, 1919, 2390, 2352, 2006, 1734, 1735, 2060, 2137, 1705, 1559, 1865, 2423, 2705, 2378, 2064, 2079, 2209, 2320, 2228, 2056, 1922, 1867, 1901, 1954, 2033, 1962, 1817, 1756, 2001, 2278, 2202, 1792, 1640, 1879, 2249, 2361, 2112, 1838, 1934, 2311, 2471, 2233, 1851, 1984, 2337, 2449, 2089, 1880, 2111, 2434, 2376, 1975, 1913, 2268, 2521, 2199, 1778, 1930, 2387, 2477, 1983, 1663, 2114, 2556, 2344, 1744, 1713, 2260, 2473, 2000, 1685, 2033, 2392, 2069, 1661, 1879, 2334, 2279, 1865, 1854, 2238, 2336, 1998, 1918, 2207, 2290, 1973, 1934, 2198, 2189, 1907, 1817, 2011, 2190, 2047, 1890, 2022, 2037, 1967, 2054, 2195, 2024, 1852, 2021, 2256, 1992, 1711, 1981, 2426, 2356, 1858, 1745, 2067, 2418, 2141, 1801, 1968, 2060, 2038, 2086, 1708, 1663, 2288, 2451, 1967, 1854, 1687, 1964, 2365, 2183, 2242, 1729, 1935, 2466, 2368, 1932, 1803, 2041, 2149, 2125, 2062, 1896, 1830, 2247, 2528, 2408, 2065, 2127, 2416, 2456, 2356, 2268, 2159, 2248, 2338, 2343, 2103, 1840, 1664, 1768, 1779, 1706, 1742, 1898, 2084, 1921, 1661, 1759, 2274, 2735, 2622, 2017, 1776, 1962, 2180, 2058, 1768, 1731, 1890, 2072, 2035, 1964, 2134, 2296, 2126, 1726, 1651, 2127, 2490, 2191, 1642, 1668, 2125, 2361, 2103, 1679, 1820, 2284, 2327, 1792, 1661, 2152, 2394, 1945, 1603, 2038, 2485, 2144, 1646, 1913, 2404, 2230, 1769, 1911, 2339, 2246, 1808, 1927, 2238, 2057, 1821, 2112, 2297, 1909, 1727, 2251, 2402, 1831, 1877, 2424, 2392, 1743, 1741, 2360, 2325, 1861, 1924, 2454, 2344, 1637, 1736, 2556, 2501, 1626, 1572, 2059, 2070, 2298, 2310, 1770, 1871, 2478, 2319, 1981, 1710, 1801, 2307, 2461, 2398, 1735, 1616, 2393, 2719, 2437, 1682, 1694, 2305, 2536, 2504, 1975, 1651, 1982, 2689, 2442, 1796, 1335, 1706, 2602, 2813, 2215, 1558, 1550, 2289, 2595, 2212, 1493, 1312, 1582, 1993, 2013, 1727, 1673, 2055, 2570, 2598, 1941, 1318, 1412, 2004, 2362, 2135, 1749, 1937, 2392, 2337, 1760, 1434, 1758, 2495, 2548, 1853, 1795, 2162, 2388, 2339, 2015, 1945, 2201, 2213, 1910, 1724, 1929, 2219, 2109, 1843, 1814, 2103, 2250, 1934, 1713, 1885, 2191, 2127, 1804, 1846, 2235, 2326, 2011, 1861, 2156, 2397, 2216, 2003, 2142, 2386, 2242, 1944, 1990, 2221, 2076, 1743, 1795, 2107, 2025, 1777, 1996, 2283, 2141, 1964, 2129, 2202, 1882, 1742, 2150, 2297, 1920, 1792, 2092, 2280, 2067, 1844, 2060, 2163, 2064, 2117, 2133, 1916, 1824, 2131, 1895, 1843, 2182, 2057, 1895, 2002, 2015, 1879, 2013, 1824, 1746, 1940, 1737, 1875, 2062, 2018, 2066, 2273, 2127, 2212, 2216, 2192, 2373, 2325, 2191, 2134, 2330, 2493, 2219, 1551, 1460, 1947, 2331, 2290, 1961, 2037, 2385, 2604, 2436, 1936, 1645, 1644, 1961, 2148, 1948, 1659, 1813, 2215, 2394, 2128, 1965, 2010, 2112, 2102, 1997, 1852, 1940, 2159, 2225, 1947, 1777, 1913, 2314, 2307, 1778, 1589, 1873, 2137, 2137, 1821, 1798, 2111, 2212, 2059, 1979, 2156, 2233, 1886, 1684, 1999, 2399, 2256, 1799, 1748, 2208, 2436, 2129, 1772, 1961, 2321, 2136, 1772, 1941, 2468, 2425, 1786, 1639, 2314, 2597, 1933, 1585, 2228, 2618, 1985, 1633, 2248, 2599, 1890, 1601, 2247, 2574, 1974, 1778, 2289, 2471, 1931, 1826, 2294, 2358, 2000, 1962, 2285, 2289, 1883, 1875, 2144, 2235, 2105, 2173, 2198, 1982, 1969, 2121, 2056, 2022, 2241, 2189, 2054, 2020, 2249, 2369, 1974, 1804, 1705, 1683, 2194, 2349, 1872, 1712, 1915, 2258, 2424, 2017, 1758, 1952, 2218, 2415, 2175, 1918, 1983, 1888, 2134, 2147, 1866, 1705, 1769, 2054, 2313, 2207, 1977, 2018, 2188, 2215, 2095, 1919, 1808, 1857, 1958, 2091, 2148, 2140, 2244, 2436, 2559, 2443, 2040, 1820, 1968, 2151, 2103, 1992, 2029, 2137, 2085, 1897, 1811, 2029, 2185, 2143, 2064, 2169, 2105, 2054, 1943, 1945, 1965, 2056, 2125, 2032, 1977, 1921, 2031, 2177, 2187, 2120, 2013, 1997, 2022, 2089, 2098, 2139, 2156, 2123, 2132, 2101, 2073, 2067, 2090, 2095, 2141, 2108, 2054, 2015, 2060, 2078, 2034, 1961, 2074, 2169, 2101, 1952, 2011, 2177, 2187, 2076, 2102, 2203, 2163, 1935, 1938, 2133, 2152, 2037, 2030, 2058, 2081, 2015, 2044, 2141, 2115, 2010, 2147, 2157, 2027, 1920, 1874, 2102, 2248, 2047, 1841, 1903, 1975, 2121, 2137, 1939, 1906, 2108, 2330, 2197, 1953, 1811, 1927, 2160, 2006, 1973, 1729, 1812, 2011, 2197, 2079, 1838, 1796, 1901, 2088, 2166, 2120, 2121, 2175, 2203, 2180, 1979, 1805, 1872, 2033, 2206, 2182, 2069, 2027, 2118, 2113, 2030, 1975, 1962, 1988, 2084, 2142, 2034, 1850, 1805, 2077, 2411, 2407, 2179, 2008, 2063, 2183, 2198, 2050, 2000, 2121, 2115, 2014, 1888, 1961, 2169, 2259, 2106, 1899, 1838, 1995, 2110, 2072, 1948, 2035, 2134, 2114, 2014, 1968, 2015, 2031, 1971, 1933, 2041, 2189, 2159, 2020, 1961, 2079, 2159, 2143, 2074, 2100, 2163, 2128, 2059, 2063, 2110, 2098, 2034, 2007, 2055, 2082, 2035, 2013, 2054, 2093, 2074, 2012, 2054, 2096, 2044, 1983, 2039, 2095, 2058, 2007, 2037, 2072, 2088, 2072, 2088, 2059, 2029, 2044, 2033, 2107, 2082, 2014, 2022, 2062, 2061, 2067, 2035, 2075, 2034, 2025, 2043, 1978, 1973, 2038, 2061, 2105, 2075, 2050, 2062, 2045, 2170, 2088, 2082, 2080, 2121, 2136, 2113, 2076, 2005, 1998, 1995, 1974, 2009, 2040, 2058, 2093, 2090, 2052, 1994, 1955, 1959, 2010, 2031, 2066, 2021, 2026, 2040, 2024, 2013, 1959, 1951, 1975, 1995, 2000, 2028, 2050, 2053, 2013, 1999, 1975, 1949, 1957, 1977, 1973, 1983, 1998, 2000, 1998, 1985, 2034, 2054, 1995, 1967, 2012, 2059, 2084, 2073, 2065, 2051, 2056, 2036, 2020, 2066, 2080, 2069, 2077, 2097, 2095, 2095, 2087, 2102, 2113, 2110, 2103, 2073, 2062, 2026, 1998, 2055, 2096, 2086, 2105, 2029, 2032, 2040, 2053, 2013, 1961, 1973, 1973, 1987, 1971, 1982, 2024, 2060, 2025, 1996, 2038, 2059, 2064, 2064, 2017, 2024, 2069, 2075, 2055, 2013, 1964, 1985, 2017, 2060, 2074, 2068, 1998, 1946, 1959, 1973, 2010, 1995, 1958, 2007, 2032, 2022, 2014, 2023, 2031, 2040, 2042, 2065, 2041, 2034, 2056, 2080, 2090, 2110, 2066, 2055, 2037, 2077, 2084, 2081, 2082, 2121, 2112, 2108, 2083, 2074, 2056, 2084, 2087, 2098, 2148, 2177, 2143, 2117, 2097, 2078, 2089, 2085, 2114, 2133, 2134, 2122, 2116, 2074, 2092, 2124, 2137, 2112, 2076, 2100, 2077, 2052, 2087, 2076, 2079, 2120, 2116, 2106, 2107, 2096, 2080, 2073, 2036, 2066, 2070, 2080, 2083, 2110, 2087, 2083, 2092, 2086, 2093, 2134, 2130, 2078, 2109, 2112, 2116, 2121, 2098, 2052, 1984, 2007, 2041, 2030, 1983, 1960, 1967, 1987, 2071, 2108, 2102, 2080, 2079, 2064, 2020, 2045, 2042, 2040, 2032, 2029, 2054, 2067, 2063, 2078, 2036, 2000, 1991, 2036, 2076, 2050, 2029, 1968, 1956, 1977, 1978, 1938, 1946, 2020, 2097, 2075, 2050, 2025, 2019, 2058, 2039, 2043, 2110, 2138, 2142, 2115, 2095, 2115, 2085, 2025, 2048, 2098, 2106, 2063, 2013, 2059, 2097, 2129, 2142, 2146, 2187, 2143, 2074, 2076, 2043, 2038, 2102, 2076, 1997, 1978, 2021, 2016, 2004, 2031, 2064, 2038, 1999, 1989, 2013, 2013, 2066, 2096, 2061, 2012, 2005, 2007, 2029, 1994, 1992, 2007, 2001, 1991, 2010, 2033, 2051, 2074, 2078, 2024, 1994, 2007, 2034, 2078, 2123, 2093, 2025, 1997, 1997, 2014, 2077, 2131, 2151, 2157, 2187, 2138, 2067, 2063, 2053, 2008, 1992, 1999, 2013, 2032, 2037, 2061, 2082, 2043, 2039, 2019, 2001, 2045, 2055, 2054, 2111, 2117, 2104, 2050, 2015, 2040, 2079, 2114, 2131, 2128, 2125, 2102, 2092, 2026, 1995, 2040, 2112, 2151, 2155, 2132, 2135, 2174, 2205, 2158, 2093, 2078, 2083, 2116, 2176, 2150, 2088, 2051, 2010, 2060, 2081, 2131, 2170, 2182, 2170, 2099, 2032, 1991, 1961, 1963, 1994, 2025, 2047, 2088, 2150, 2141, 2101, 2090, 2080, 2129, 2118, 2023, 2011, 2036, 2085, 2127, 2083, 2042, 2036, 2023, 2014, 1998, 1988, 1951, 1936, 1951, 1985, 2000, 1998, 2016, 2053, 2089, 2100, 2073, 2113, 2111, 2124, 2059, 2019, 1974, 1940, 1913, 1936, 1930, 1894, 1897, 1903, 1896, 1919, 1954, 1964, 1947, 1942, 1930, 1923, 1922, 1917, 1935, 1910, 1928, 1945, 1963, 1999, 1989, 1991, 2007, 2012, 1994, 2009, 1998, 1997, 2009, 2007, 2026, 2041, 1985, 1978, 1940, 1940, 1973, 1969, 1971, 2003, 2028, 2080, 2084, 2153, 2190, 2197, 2204, 2181, 2159, 2134, 2133, 2118, 2103, 2093, 2108, 2084, 2079, 2075, 2069, 2060, 2081, 2116, 2119, 2107, 2111, 2103, 2107, 2128, 2097, 2095];

% I=[2028, 2002, 2040, 2068, 2045, 1988, 1999, 2000, 2023, 2009, 2029, 2072, 2057, 2048, 2076, 2131, 2064, 2010, 2042, 2061, 2069, 2074, 2026, 2028, 2077, 2086, 2082, 2030, 2010, 2062, 2117, 2060, 2016, 1992, 2063, 2121, 2069, 1966, 1975, 2099, 2150, 2082, 1992, 2000, 2065, 2146, 2089, 2015, 1980, 2087, 2157, 2125, 2022, 1980, 2030, 2128, 2128, 1981, 1933, 2071, 2245, 2214, 2043, 1950, 2001, 2075, 2043, 1960, 1977, 2086, 2133, 2067, 1981, 2010, 2145, 2146, 2029, 1887, 1960, 2109, 2153, 2045, 1974, 2001, 2094, 2100, 2019, 1957, 2026, 2129, 2081, 1985, 2021, 2132, 2144, 1996, 1949, 2052, 2126, 2056, 1973, 2054, 2133, 2093, 2032, 2036, 2118, 2121, 2023, 1993, 2083, 2127, 2019, 1992, 2078, 2126, 2048, 1997, 2054, 2104, 2041, 2011, 2077, 2075, 2055, 2062, 2097, 2035, 1995, 2068, 2104, 2035, 2019, 2088, 2120, 2074, 2019, 2030, 2100, 2141, 2070, 2041, 2147, 2138, 2056, 1974, 1910, 2007, 2224, 2100, 1839, 1969, 2187, 2158, 2053, 1929, 1934, 2085, 2180, 2067, 1949, 2011, 2125, 2119, 1988, 1857, 1927, 2174, 2184, 2038, 1942, 2021, 2152, 2200, 2061, 1926, 1926, 2057, 2176, 2080, 2005, 2106, 2264, 2358, 2257, 2062, 1953, 1962, 2038, 2072, 2005, 1932, 1993, 2062, 2055, 1975, 1889, 1913, 2006, 2098, 2107, 2002, 2021, 2140, 2179, 2094, 1970, 2023, 2118, 2098, 1992, 1915, 1994, 2115, 2142, 1988, 1958, 2039, 2096, 2073, 1925, 1933, 2017, 2125, 2092, 1987, 1958, 2064, 2138, 2064, 1938, 1950, 2079, 2117, 2003, 1918, 2012, 2108, 2080, 1946, 1957, 2101, 2119, 1996, 1911, 2021, 2132, 2050, 1947, 2026, 2146, 2081, 1976, 2020, 2144, 2094, 1959, 2009, 2144, 2064, 1949, 2046, 2169, 2069, 1957, 2071, 2191, 2004, 1892, 2090, 2179, 1997, 1950, 2159, 2253, 2089, 1908, 1889, 2119, 2279, 1967, 1775, 2124, 2318, 2148, 2018, 1982, 2123, 2342, 2206, 1940, 1949, 2042, 2248, 2218, 1903, 1935, 2092, 2221, 2197, 2009, 1951, 2041, 2122, 2142, 2063, 1999, 2061, 2084, 2043, 1990, 2009, 2093, 2193, 2218, 2228, 2112, 1904, 1739, 1729, 1784, 1812, 1845, 1972, 2071, 2163, 2125, 1989, 1943, 2032, 2114, 2153, 2125, 2009, 1933, 1968, 2103, 2181, 2075, 2074, 2181, 2236, 2097, 2007, 2077, 2184, 2212, 2071, 2058, 2067, 2097, 2080, 2123, 2167, 2148, 2057, 1990, 2072, 2143, 2084, 1982, 2009, 2127, 2118, 1980, 1941, 2069, 2211, 2091, 1902, 1953, 2161, 2149, 1920, 1924, 2168, 2198, 1944, 1881, 2152, 2221, 1972, 1916, 2172, 2217, 1942, 1909, 2165, 2139, 1928, 2000, 2202, 2082, 1955, 2078, 2061, 1972, 2068, 2156, 2167, 2093, 2038, 2007, 2014, 2085, 2135, 2091, 2079, 2104, 2128, 2067, 2024, 1885, 1937, 2162, 2123, 2054, 2095, 2012, 1955, 2303, 2100, 1796, 2048, 2154, 2406, 2312, 1802, 1873, 2015, 2157, 2432, 2072, 1843, 2020, 2264, 2414, 2064, 1707, 1821, 2152, 2404, 2281, 2004, 2030, 2323, 2362, 2004, 1503, 1413, 1768, 1982, 1946, 1895, 1869, 2003, 2164, 2237, 2246, 2206, 2141, 2108, 2163, 2280, 2274, 1995, 1910, 2021, 2313, 2349, 2077, 1775, 1830, 2096, 2226, 2039, 1741, 1753, 1991, 2251, 2044, 1739, 1764, 2095, 2161, 1937, 1739, 1862, 2196, 2163, 1829, 1694, 2013, 2275, 2041, 1679, 1766, 2212, 2304, 1904, 1670, 1949, 2375, 2249, 1783, 1745, 2178, 2354, 1974, 1788, 2127, 2414, 2118, 1794, 1945, 2250, 2148, 1821, 1867, 2127, 2143, 1890, 1880, 2153, 2116, 1893, 1964, 2221, 2216, 2046, 1916, 2091, 2225, 2088, 2067, 2099, 2001, 1947, 2137, 2239, 2037, 1893, 2143, 2283, 1988, 1753, 1956, 2334, 2301, 1983, 1737, 2069, 2321, 2143, 2088, 2093, 2117, 2358, 2228, 1753, 1836, 2201, 2200, 2255, 1908, 1749, 1975, 1972, 2313, 1994, 1718, 1816, 2189, 2298, 2060, 1992, 1944, 2084, 2255, 2142, 1810, 1634, 1821, 2075, 1915, 1725, 1735, 1851, 1922, 1966, 1889, 1832, 1926, 2201, 2352, 2433, 2333, 2320, 2362, 2268, 2127, 2035, 2185, 2342, 2117, 1649, 1453, 1725, 2197, 2294, 2074, 1993, 2150, 2330, 2269, 2117, 2019, 2078, 2110, 1990, 1883, 2084, 2389, 2321, 1887, 1693, 2054, 2429, 2257, 1885, 1768, 2103, 2369, 2154, 1815, 1904, 2322, 2325, 1853, 1796, 2239, 2385, 1942, 1712, 2052, 2341, 2056, 1757, 2025, 2327, 2123, 1822, 1978, 2281, 2130, 1941, 2096, 2203, 1946, 1848, 2225, 2253, 1774, 1828, 2257, 2118, 1730, 1891, 2382, 2265, 1724, 1849, 2207, 2052, 1665, 1932, 2451, 2185, 1569, 1815, 2511, 2367, 2017, 1989, 1786, 1906, 2318, 2061, 1644, 1881, 2152, 2349, 2174, 1766, 1706, 1856, 2394, 2260, 1626, 1538, 1886, 2489, 2347, 1753, 1622, 1739, 2288, 2449, 2038, 1596, 1884, 2436, 2666, 2184, 1536, 1533, 2118, 2599, 2435, 1815, 1758, 2163, 2739, 2800, 2338, 2015, 2111, 2354, 2274, 1912, 1549, 1731, 2347, 2753, 2476, 1978, 1799, 2086, 2314, 2038, 1745, 1913, 2383, 2527, 2087, 1578, 1713, 2249, 2183, 1864, 1781, 1881, 2101, 2077, 1879, 1934, 2175, 2274, 2055, 1905, 2035, 2247, 2172, 1969, 1921, 2167, 2299, 2064, 1835, 1989, 2235, 2117, 1826, 1817, 2074, 2154, 1921, 1793, 1971, 2091, 1913, 1782, 1985, 2205, 2068, 1915, 2126, 2358, 2205, 1978, 2096, 2255, 1996, 1837, 2050, 2167, 1974, 1973, 2260, 2251, 1898, 1901, 2210, 2208, 1950, 1886, 2074, 2233, 2016, 1964, 2014, 2012, 2033, 2226, 2220, 2024, 2210, 2174, 1955, 2125, 2239, 2100, 2136, 2247, 2137, 2308, 2295, 2173, 2313, 2114, 1962, 2003, 1914, 1852, 1966, 1887, 1913, 1846, 1781, 1855, 1918, 2031, 1854, 1794, 2072, 2596, 2525, 1982, 1736, 1893, 2113, 2025, 1756, 1684, 1941, 2344, 2521, 2384, 2094, 1977, 2159, 2358, 2153, 1833, 1818, 2079, 2182, 2113, 2004, 2017, 2157, 2240, 2134, 1943, 1944, 2156, 2245, 2032, 1784, 1920, 2359, 2431, 2132, 1946, 1990, 2255, 2203, 1952, 1919, 2080, 2109, 1957, 2003, 2288, 2350, 2037, 1761, 1960, 2296, 2234, 1860, 1786, 2113, 2328, 2066, 1814, 2055, 2326, 2048, 1672, 1872, 2376, 2313, 1733, 1681, 2276, 2379, 1760, 1635, 2233, 2356, 1780, 1669, 2255, 2351, 1778, 1705, 2209, 2234, 1789, 1793, 2212, 2173, 1781, 1861, 2128, 2077, 1805, 1898, 2217, 2156, 1916, 1914, 1990, 1919, 1972, 2157, 2075, 1981, 2048, 2018, 1900, 1970, 2056, 2022, 1834, 1883, 2244, 2338, 2390, 2251, 1837, 1812, 2208, 2258, 2029, 1783, 1723, 2168, 2340, 2090, 1803, 1744, 2012, 2203, 2088, 2139, 1996, 2014, 2241, 2205, 2192, 1999, 1808, 1972, 2162, 2073, 1961, 1937, 2057, 2215, 2248, 2156, 2031, 1955, 1902, 1901, 1803, 1684, 1666, 1861, 2173, 2288, 2154, 1997, 2022, 2090, 2043, 2001, 2070, 2215, 2195, 2011, 1924, 2003, 2043, 1972, 2042, 2077, 2132, 2085, 2121, 2076, 2049, 2100, 2141, 2148, 2063, 1960, 1923, 1997, 2119, 2125, 2072, 2020, 2008, 1988, 1975, 1963, 1966, 2042, 2052, 2085, 2062, 2061, 2051, 2089, 2115, 2104, 2058, 2064, 2129, 2145, 2035, 1945, 2029, 2085, 2035, 1947, 1969, 2047, 2014, 1943, 1981, 2133, 2131, 1991, 1972, 2085, 2110, 2084, 2077, 2135, 2046, 1990, 2046, 2080, 1973, 1993, 2098, 2190, 2186, 1971, 1906, 2123, 2245, 2124, 2040, 1949, 2029, 2152, 2147, 2009, 1884, 2014, 2189, 2226, 2114, 1979, 2139, 2155, 2304, 2200, 2009, 1919, 2076, 2251, 2143, 2083, 2021, 1990, 2032, 2001, 1972, 1973, 2009, 2144, 2253, 2126, 2027, 1957, 1957, 2028, 2033, 1994, 2033, 2098, 2158, 2127, 2083, 2023, 2020, 2132, 2224, 2148, 1901, 1713, 1812, 1955, 2053, 2002, 1913, 1962, 2046, 2010, 1985, 1992, 2095, 2196, 2082, 1905, 1854, 2010, 2171, 2161, 2052, 1992, 2058, 2128, 2061, 1977, 2022, 2092, 2130, 2099, 2096, 2138, 2139, 2017, 1936, 1988, 2098, 2079, 1995, 1966, 1993, 2018, 1999, 1977, 2056, 2107, 2080, 1993, 1989, 2058, 2097, 2066, 2045, 2062, 2058, 2027, 2008, 2039, 2067, 2034, 2019, 2062, 2129, 2060, 2054, 2078, 2093, 2087, 2053, 2053, 2065, 2043, 2103, 2092, 2061, 2046, 2025, 2042, 2078, 2075, 2075, 2056, 2069, 2070, 2039, 2037, 2060, 2057, 2084, 2069, 2058, 2047, 1981, 2006, 2046, 2034, 2014, 2020, 2022, 2091, 2051, 2028, 2007, 1987, 1993, 2024, 2012, 2035, 2052, 2077, 2067, 2072, 2044, 2039, 2047, 2053, 2125, 2101, 2060, 2063, 2042, 2038, 2073, 2091, 2110, 2146, 2158, 2131, 2097, 2094, 2089, 2073, 2042, 2030, 2035, 2083, 2138, 2170, 2177, 2133, 2097, 2106, 2111, 2128, 2112, 2092, 2061, 2089, 2108, 2131, 2103, 2106, 2107, 2099, 2077, 2055, 2070, 2098, 2083, 2062, 2037, 1981, 2021, 2041, 2027, 2005, 2011, 2012, 2018, 2016, 2009, 1983, 2006, 2055, 2083, 2082, 2031, 1988, 2026, 2058, 2057, 2034, 2022, 2059, 2100, 2077, 2095, 2101, 2123, 2139, 2101, 2073, 2088, 2108, 2092, 2083, 2073, 2065, 2076, 2075, 2082, 2082, 2071, 2111, 2084, 2062, 2066, 2049, 2053, 2081, 2082, 2093, 2090, 2087, 2121, 2136, 2133, 2133, 2114, 2066, 2080, 2102, 2078, 2100, 2081, 2055, 2040, 2036, 2044, 2025, 1999, 1996, 2020, 2030, 2063, 2022, 2025, 2026, 2008, 1998, 1976, 2005, 2038, 2051, 2045, 2028, 2024, 2016, 1988, 1982, 1995, 1988, 1994, 2033, 2044, 2042, 2038, 1988, 1975, 2010, 2041, 2023, 2014, 1994, 1999, 2012, 2051, 2051, 2038, 2039, 2036, 2035, 2029, 2013, 1973, 1966, 1998, 2035, 2063, 2051, 2042, 2031, 2009, 2007, 2003, 2039, 2048, 2040, 2012, 2008, 1987, 1957, 1965, 1999, 2022, 2018, 2055, 2012, 1999, 2059, 2120, 2110, 2086, 2068, 2095, 2110, 2123, 2138, 2082, 2054, 2063, 2071, 2081, 2065, 2059, 2079, 2115, 2100, 2067, 2078, 2091, 2062, 2075, 2106, 2130, 2144, 2155, 2118, 2052, 2024, 2089, 2155, 2165, 2107, 2130, 2171, 2168, 2114, 2048, 2044, 2061, 2091, 2064, 2035, 2067, 2050, 1976, 1922, 1917, 1953, 1983, 2013, 2020, 2028, 2032, 2023, 1964, 2073, 2094, 2066, 2056, 2080, 2049, 1964, 1952, 1979, 1995, 2033, 2110, 2132, 2055, 2046, 2093, 2069, 2057, 2042, 2021, 2015, 2074, 2065, 2062, 2090, 2097, 2130, 2108, 2061, 2062, 2085, 2071, 2040, 2101, 2138, 2086, 2086, 2111, 2135, 2093, 2065, 2073, 2063, 2052, 2063, 2076, 2055, 1997, 1955, 1944, 2002, 2034, 2072, 2060, 2045, 2022, 1964, 1960, 1948, 1941, 1924, 1967, 2005, 1999, 2025, 2078, 2136, 2141, 2129, 2114, 2103, 2069, 2051, 2045, 2046, 2023, 2029, 2034, 2015, 2048, 2068, 2052, 2059, 2051, 2002, 1938, 1963, 1970, 1978, 1963, 1980, 2034, 2058, 2058, 2018, 2036, 2049, 2063, 2062, 1974, 1886, 1883, 2003, 2109, 2153, 2097, 1999, 1966, 1970, 2008, 2064, 2094, 2113, 2076, 2006, 1916, 1876, 1895, 1994, 2128, 2192, 2190, 2192, 2141, 2091, 2075, 2050, 2064, 2045, 2046, 2012, 1990, 2022, 2081, 2157, 2142, 2086, 1953, 1933, 2035, 2129, 2152, 2114, 2093, 2105, 2127, 2112, 2112, 2110, 2116, 2111, 2105, 2075, 2031, 2028, 2067, 2071, 2058, 2042, 2039, 2042, 2058, 2083, 2040, 2029, 2070, 2129, 2140, 2137, 2125, 2095, 2094 ];
% Q=[2067, 2100, 2081, 2031, 2064, 2106, 2097, 2055, 2084, 2121, 2078, 2036, 2005, 2049, 2043, 1984, 2063, 2131, 2109, 2046, 2067, 2062, 2144, 2166, 2102, 2043, 2022, 2076, 2162, 2096, 1994, 2013, 2086, 2116, 2036, 1964, 2036, 2158, 2168, 2053, 1962, 2025, 2113, 2152, 2103, 1983, 1942, 2036, 2130, 2086, 1939, 1885, 2020, 2141, 2091, 1960, 1949, 2103, 2234, 2134, 1909, 1830, 2010, 2194, 2153, 2051, 2037, 2129, 2154, 2074, 1994, 2029, 2162, 2153, 1996, 1908, 2035, 2183, 2190, 2036, 1933, 2015, 2133, 2150, 1966, 1985, 2061, 2159, 2127, 2011, 2011, 2130, 2118, 1977, 1893, 2074, 2174, 2075, 1954, 2026, 2167, 2086, 1944, 1957, 2097, 2107, 1992, 1963, 2097, 2142, 2017, 1924, 2056, 2127, 2040, 1951, 2040, 2102, 2052, 1992, 2007, 2074, 2072, 2036, 2068, 2058, 2020, 2096, 2112, 2045, 1965, 2044, 2059, 2007, 1975, 2009, 2104, 2101, 2007, 1944, 2019, 2048, 1945, 1921, 2014, 2107, 2205, 2164, 1886, 1930, 2275, 2225, 1912, 1889, 1995, 2149, 2197, 2063, 1922, 1998, 2148, 2122, 2002, 1974, 2051, 2240, 2246, 1985, 1895, 2071, 2200, 2121, 1983, 1866, 1979, 2116, 2228, 2137, 1994, 2030, 2175, 2131, 1900, 1724, 1824, 2003, 2148, 2157, 2026, 1969, 2066, 2190, 2174, 2075, 1984, 2089, 2209, 2253, 2174, 2036, 2010, 2082, 2041, 1963, 1922, 1979, 2106, 2079, 1959, 1878, 2090, 2268, 2223, 2058, 1971, 2050, 2173, 2059, 1984, 1975, 2153, 2209, 2099, 1940, 1957, 2096, 2161, 2089, 1982, 1989, 2144, 2182, 2033, 1943, 2074, 2214, 2168, 1983, 1976, 2147, 2184, 2026, 1933, 2056, 2190, 2089, 1936, 2017, 2155, 2104, 1956, 1954, 2110, 2067, 1921, 1984, 2176, 2138, 1952, 2003, 2218, 2139, 1945, 1981, 2175, 2086, 1911, 2037, 2213, 2079, 1928, 2109, 2253, 2031, 1855, 1932, 2191, 2284, 2046, 1808, 2077, 2427, 2065, 1729, 1900, 2095, 2186, 2071, 1755, 1743, 2121, 2241, 2188, 1931, 1804, 2182, 2255, 2090, 1942, 1853, 2002, 2155, 2087, 1977, 1954, 2027, 2084, 2054, 2001, 2056, 2087, 2135, 2038, 1886, 1835, 1747, 1839, 2086, 2294, 2367, 2350, 2358, 2357, 2255, 2162, 1997, 1977, 2108, 2174, 2127, 1986, 1910, 1917, 2001, 2149, 2165, 1972, 1881, 2018, 2088, 1937, 1819, 1918, 2081, 2079, 1942, 1847, 1988, 2055, 2018, 2002, 2007, 1992, 1891, 1911, 1989, 2075, 1995, 1885, 1989, 2084, 2087, 1962, 1949, 2086, 2213, 2092, 1898, 1990, 2261, 2234, 1962, 1903, 2182, 2247, 1992, 1866, 2121, 2282, 2006, 1847, 2139, 2276, 1982, 1855, 2152, 2258, 1936, 1911, 2228, 2216, 1940, 2006, 2159, 2008, 2008, 2139, 2096, 1977, 1937, 2028, 2102, 2114, 2124, 2067, 1978, 1996, 2057, 2018, 1974, 2015, 2022, 2233, 2289, 1990, 1967, 2065, 2025, 2125, 2237, 1795, 1882, 2356, 2137, 2011, 1775, 1699, 2288, 2319, 2107, 2003, 1585, 1932, 2344, 2184, 1882, 1654, 1919, 2390, 2352, 2006, 1734, 1735, 2060, 2137, 1705, 1559, 1865, 2423, 2705, 2378, 2064, 2079, 2209, 2320, 2228, 2056, 1922, 1867, 1901, 1954, 2033, 1962, 1817, 1756, 2001, 2278, 2202, 1792, 1640, 1879, 2249, 2361, 2112, 1838, 1934, 2311, 2471, 2233, 1851, 1984, 2337, 2449, 2089, 1880, 2111, 2434, 2376, 1975, 1913, 2268, 2521, 2199, 1778, 1930, 2387, 2477, 1983, 1663, 2114, 2556, 2344, 1744, 1713, 2260, 2473, 2000, 1685, 2033, 2392, 2069, 1661, 1879, 2334, 2279, 1865, 1854, 2238, 2336, 1998, 1918, 2207, 2290, 1973, 1934, 2198, 2189, 1907, 1817, 2011, 2190, 2047, 1890, 2022, 2037, 1967, 2054, 2195, 2024, 1852, 2021, 2256, 1992, 1711, 1981, 2426, 2356, 1858, 1745, 2067, 2418, 2141, 1801, 1968, 2060, 2038, 2086, 1708, 1663, 2288, 2451, 1967, 1854, 1687, 1964, 2365, 2183, 2242, 1729, 1935, 2466, 2368, 1932, 1803, 2041, 2149, 2125, 2062, 1896, 1830, 2247, 2528, 2408, 2065, 2127, 2416, 2456, 2356, 2268, 2159, 2248, 2338, 2343, 2103, 1840, 1664, 1768, 1779, 1706, 1742, 1898, 2084, 1921, 1661, 1759, 2274, 2735, 2622, 2017, 1776, 1962, 2180, 2058, 1768, 1731, 1890, 2072, 2035, 1964, 2134, 2296, 2126, 1726, 1651, 2127, 2490, 2191, 1642, 1668, 2125, 2361, 2103, 1679, 1820, 2284, 2327, 1792, 1661, 2152, 2394, 1945, 1603, 2038, 2485, 2144, 1646, 1913, 2404, 2230, 1769, 1911, 2339, 2246, 1808, 1927, 2238, 2057, 1821, 2112, 2297, 1909, 1727, 2251, 2402, 1831, 1877, 2424, 2392, 1743, 1741, 2360, 2325, 1861, 1924, 2454, 2344, 1637, 1736, 2556, 2501, 1626, 1572, 2059, 2070, 2298, 2310, 1770, 1871, 2478, 2319, 1981, 1710, 1801, 2307, 2461, 2398, 1735, 1616, 2393, 2719, 2437, 1682, 1694, 2305, 2536, 2504, 1975, 1651, 1982, 2689, 2442, 1796, 1335, 1706, 2602, 2813, 2215, 1558, 1550, 2289, 2595, 2212, 1493, 1312, 1582, 1993, 2013, 1727, 1673, 2055, 2570, 2598, 1941, 1318, 1412, 2004, 2362, 2135, 1749, 1937, 2392, 2337, 1760, 1434, 1758, 2495, 2548, 1853, 1795, 2162, 2388, 2339, 2015, 1945, 2201, 2213, 1910, 1724, 1929, 2219, 2109, 1843, 1814, 2103, 2250, 1934, 1713, 1885, 2191, 2127, 1804, 1846, 2235, 2326, 2011, 1861, 2156, 2397, 2216, 2003, 2142, 2386, 2242, 1944, 1990, 2221, 2076, 1743, 1795, 2107, 2025, 1777, 1996, 2283, 2141, 1964, 2129, 2202, 1882, 1742, 2150, 2297, 1920, 1792, 2092, 2280, 2067, 1844, 2060, 2163, 2064, 2117, 2133, 1916, 1824, 2131, 1895, 1843, 2182, 2057, 1895, 2002, 2015, 1879, 2013, 1824, 1746, 1940, 1737, 1875, 2062, 2018, 2066, 2273, 2127, 2212, 2216, 2192, 2373, 2325, 2191, 2134, 2330, 2493, 2219, 1551, 1460, 1947, 2331, 2290, 1961, 2037, 2385, 2604, 2436, 1936, 1645, 1644, 1961, 2148, 1948, 1659, 1813, 2215, 2394, 2128, 1965, 2010, 2112, 2102, 1997, 1852, 1940, 2159, 2225, 1947, 1777, 1913, 2314, 2307, 1778, 1589, 1873, 2137, 2137, 1821, 1798, 2111, 2212, 2059, 1979, 2156, 2233, 1886, 1684, 1999, 2399, 2256, 1799, 1748, 2208, 2436, 2129, 1772, 1961, 2321, 2136, 1772, 1941, 2468, 2425, 1786, 1639, 2314, 2597, 1933, 1585, 2228, 2618, 1985, 1633, 2248, 2599, 1890, 1601, 2247, 2574, 1974, 1778, 2289, 2471, 1931, 1826, 2294, 2358, 2000, 1962, 2285, 2289, 1883, 1875, 2144, 2235, 2105, 2173, 2198, 1982, 1969, 2121, 2056, 2022, 2241, 2189, 2054, 2020, 2249, 2369, 1974, 1804, 1705, 1683, 2194, 2349, 1872, 1712, 1915, 2258, 2424, 2017, 1758, 1952, 2218, 2415, 2175, 1918, 1983, 1888, 2134, 2147, 1866, 1705, 1769, 2054, 2313, 2207, 1977, 2018, 2188, 2215, 2095, 1919, 1808, 1857, 1958, 2091, 2148, 2140, 2244, 2436, 2559, 2443, 2040, 1820, 1968, 2151, 2103, 1992, 2029, 2137, 2085, 1897, 1811, 2029, 2185, 2143, 2064, 2169, 2105, 2054, 1943, 1945, 1965, 2056, 2125, 2032, 1977, 1921, 2031, 2177, 2187, 2120, 2013, 1997, 2022, 2089, 2098, 2139, 2156, 2123, 2132, 2101, 2073, 2067, 2090, 2095, 2141, 2108, 2054, 2015, 2060, 2078, 2034, 1961, 2074, 2169, 2101, 1952, 2011, 2177, 2187, 2076, 2102, 2203, 2163, 1935, 1938, 2133, 2152, 2037, 2030, 2058, 2081, 2015, 2044, 2141, 2115, 2010, 2147, 2157, 2027, 1920, 1874, 2102, 2248, 2047, 1841, 1903, 1975, 2121, 2137, 1939, 1906, 2108, 2330, 2197, 1953, 1811, 1927, 2160, 2006, 1973, 1729, 1812, 2011, 2197, 2079, 1838, 1796, 1901, 2088, 2166, 2120, 2121, 2175, 2203, 2180, 1979, 1805, 1872, 2033, 2206, 2182, 2069, 2027, 2118, 2113, 2030, 1975, 1962, 1988, 2084, 2142, 2034, 1850, 1805, 2077, 2411, 2407, 2179, 2008, 2063, 2183, 2198, 2050, 2000, 2121, 2115, 2014, 1888, 1961, 2169, 2259, 2106, 1899, 1838, 1995, 2110, 2072, 1948, 2035, 2134, 2114, 2014, 1968, 2015, 2031, 1971, 1933, 2041, 2189, 2159, 2020, 1961, 2079, 2159, 2143, 2074, 2100, 2163, 2128, 2059, 2063, 2110, 2098, 2034, 2007, 2055, 2082, 2035, 2013, 2054, 2093, 2074, 2012, 2054, 2096, 2044, 1983, 2039, 2095, 2058, 2007, 2037, 2072, 2088, 2072, 2088, 2059, 2029, 2044, 2033, 2107, 2082, 2014, 2022, 2062, 2061, 2067, 2035, 2075, 2034, 2025, 2043, 1978, 1973, 2038, 2061, 2105, 2075, 2050, 2062, 2045, 2170, 2088, 2082, 2080, 2121, 2136, 2113, 2076, 2005, 1998, 1995, 1974, 2009, 2040, 2058, 2093, 2090, 2052, 1994, 1955, 1959, 2010, 2031, 2066, 2021, 2026, 2040, 2024, 2013, 1959, 1951, 1975, 1995, 2000, 2028, 2050, 2053, 2013, 1999, 1975, 1949, 1957, 1977, 1973, 1983, 1998, 2000, 1998, 1985, 2034, 2054, 1995, 1967, 2012, 2059, 2084, 2073, 2065, 2051, 2056, 2036, 2020, 2066, 2080, 2069, 2077, 2097, 2095, 2095, 2087, 2102, 2113, 2110, 2103, 2073, 2062, 2026, 1998, 2055, 2096, 2086, 2105, 2029, 2032, 2040, 2053, 2013, 1961, 1973, 1973, 1987, 1971, 1982, 2024, 2060, 2025, 1996, 2038, 2059, 2064, 2064, 2017, 2024, 2069, 2075, 2055, 2013, 1964, 1985, 2017, 2060, 2074, 2068, 1998, 1946, 1959, 1973, 2010, 1995, 1958, 2007, 2032, 2022, 2014, 2023, 2031, 2040, 2042, 2065, 2041, 2034, 2056, 2080, 2090, 2110, 2066, 2055, 2037, 2077, 2084, 2081, 2082, 2121, 2112, 2108, 2083, 2074, 2056, 2084, 2087, 2098, 2148, 2177, 2143, 2117, 2097, 2078, 2089, 2085, 2114, 2133, 2134, 2122, 2116, 2074, 2092, 2124, 2137, 2112, 2076, 2100, 2077, 2052, 2087, 2076, 2079, 2120, 2116, 2106, 2107, 2096, 2080, 2073, 2036, 2066, 2070, 2080, 2083, 2110, 2087, 2083, 2092, 2086, 2093, 2134, 2130, 2078, 2109, 2112, 2116, 2121, 2098, 2052, 1984, 2007, 2041, 2030, 1983, 1960, 1967, 1987, 2071, 2108, 2102, 2080, 2079, 2064, 2020, 2045, 2042, 2040, 2032, 2029, 2054, 2067, 2063, 2078, 2036, 2000, 1991, 2036, 2076, 2050, 2029, 1968, 1956, 1977, 1978, 1938, 1946, 2020, 2097, 2075, 2050, 2025, 2019, 2058, 2039, 2043, 2110, 2138, 2142, 2115, 2095, 2115, 2085, 2025, 2048, 2098, 2106, 2063, 2013, 2059, 2097, 2129, 2142, 2146, 2187, 2143, 2074, 2076, 2043, 2038, 2102, 2076, 1997, 1978, 2021, 2016, 2004, 2031, 2064, 2038, 1999, 1989, 2013, 2013, 2066, 2096, 2061, 2012, 2005, 2007, 2029, 1994, 1992, 2007, 2001, 1991, 2010, 2033, 2051, 2074, 2078, 2024, 1994, 2007, 2034, 2078, 2123, 2093, 2025, 1997, 1997, 2014, 2077, 2131, 2151, 2157, 2187, 2138, 2067, 2063, 2053, 2008, 1992, 1999, 2013, 2032, 2037, 2061, 2082, 2043, 2039, 2019, 2001, 2045, 2055, 2054, 2111, 2117, 2104, 2050, 2015, 2040, 2079, 2114, 2131, 2128, 2125, 2102, 2092, 2026, 1995, 2040, 2112, 2151, 2155, 2132, 2135, 2174, 2205, 2158, 2093, 2078, 2083, 2116, 2176, 2150, 2088, 2051, 2010, 2060, 2081, 2131, 2170, 2182, 2170, 2099, 2032, 1991, 1961, 1963, 1994, 2025, 2047, 2088, 2150, 2141, 2101, 2090, 2080, 2129, 2118, 2023, 2011, 2036, 2085, 2127, 2083, 2042, 2036, 2023, 2014, 1998, 1988, 1951, 1936, 1951, 1985, 2000, 1998, 2016, 2053, 2089, 2100, 2073, 2113, 2111, 2124, 2059, 2019, 1974, 1940, 1913, 1936, 1930, 1894, 1897, 1903, 1896, 1919 ];

% I=[2028, 2002, 2040, 2068, 2045, 1988, 1999, 2000, 2023, 2009, 2029, 2072, 2057, 2048, 2076, 2131, 2064, 2010, 2042, 2061, 2069, 2074, 2026, 2028, 2077, 2086, 2082, 2030, 2010, 2062, 2117, 2060, 2016, 1992, 2063, 2121, 2069, 1966, 1975, 2099, 2150, 2082, 1992, 2000, 2065, 2146, 2089, 2015, 1980, 2087, 2157, 2125, 2022, 1980, 2030, 2128, 2128, 1981, 1933, 2071, 2245, 2214, 2043, 1950, 2001, 2075, 2043, 1960, 1977, 2086, 2133, 2067, 1981, 2010, 2145, 2146, 2029, 1887, 1960, 2109, 2153, 2045, 1974, 2001, 2094, 2100, 2019, 1957, 2026, 2129, 2081, 1985, 2021, 2132, 2144, 1996, 1949, 2052, 2126, 2056, 1973, 2054, 2133, 2093, 2032, 2036, 2118, 2121, 2023, 1993, 2083, 2127, 2019, 1992, 2078, 2126, 2048, 1997, 2054, 2104, 2041, 2011, 2077, 2075, 2055, 2062, 2097, 2035, 1995, 2068, 2104, 2035, 2019, 2088, 2120, 2074, 2019, 2030, 2100, 2141, 2070, 2041, 2147, 2138, 2056, 1974, 1910, 2007, 2224, 2100, 1839, 1969, 2187, 2158, 2053, 1929, 1934, 2085, 2180, 2067, 1949, 2011, 2125, 2119, 1988, 1857, 1927, 2174, 2184, 2038, 1942, 2021, 2152, 2200, 2061, 1926, 1926, 2057, 2176, 2080, 2005, 2106, 2264, 2358, 2257, 2062, 1953, 1962, 2038, 2072, 2005, 1932, 1993, 2062, 2055, 1975, 1889, 1913, 2006, 2098, 2107, 2002, 2021, 2140, 2179, 2094, 1970, 2023, 2118, 2098, 1992, 1915, 1994, 2115, 2142, 1988, 1958, 2039, 2096, 2073, 1925, 1933, 2017, 2125, 2092, 1987, 1958, 2064, 2138, 2064, 1938, 1950, 2079, 2117, 2003, 1918, 2012, 2108, 2080, 1946, 1957, 2101, 2119, 1996, 1911, 2021, 2132, 2050, 1947, 2026, 2146, 2081, 1976, 2020, 2144, 2094, 1959, 2009, 2144, 2064, 1949, 2046, 2169, 2069, 1957, 2071, 2191, 2004, 1892, 2090, 2179, 1997, 1950, 2159, 2253, 2089, 1908, 1889, 2119, 2279, 1967, 1775, 2124, 2318, 2148, 2018, 1982, 2123, 2342, 2206, 1940, 1949, 2042, 2248, 2218, 1903, 1935, 2092, 2221, 2197, 2009, 1951, 2041, 2122, 2142, 2063, 1999, 2061, 2084, 2043, 1990, 2009, 2093, 2193, 2218, 2228, 2112, 1904, 1739, 1729, 1784, 1812, 1845, 1972, 2071, 2163, 2125, 1989, 1943, 2032, 2114, 2153, 2125, 2009, 1933, 1968, 2103, 2181, 2075, 2074, 2181, 2236, 2097, 2007, 2077, 2184, 2212, 2071, 2058, 2067, 2097, 2080, 2123, 2167, 2148, 2057, 1990, 2072, 2143, 2084, 1982, 2009, 2127, 2118, 1980, 1941, 2069, 2211, 2091, 1902, 1953, 2161, 2149, 1920, 1924, 2168, 2198, 1944, 1881, 2152, 2221, 1972, 1916, 2172, 2217, 1942, 1909, 2165, 2139, 1928, 2000, 2202, 2082, 1955, 2078, 2061, 1972, 2068, 2156, 2167, 2093, 2038, 2007, 2014, 2085, 2135, 2091, 2079, 2104, 2128, 2067, 2024, 1885, 1937, 2162, 2123, 2054, 2095, 2012, 1955, 2303, 2100, 1796, 2048, 2154, 2406, 2312, 1802, 1873, 2015, 2157, 2432, 2072, 1843, 2020, 2264, 2414, 2064, 1707, 1821, 2152, 2404, 2281, 2004, 2030, 2323, 2362, 2004, 1503, 1413, 1768, 1982, 1946, 1895, 1869, 2003, 2164, 2237, 2246, 2206, 2141, 2108, 2163, 2280, 2274, 1995, 1910, 2021, 2313, 2349, 2077, 1775, 1830, 2096, 2226, 2039, 1741, 1753, 1991, 2251, 2044, 1739, 1764, 2095, 2161, 1937, 1739, 1862, 2196, 2163, 1829, 1694, 2013, 2275, 2041, 1679, 1766, 2212, 2304, 1904, 1670, 1949, 2375, 2249, 1783, 1745, 2178, 2354, 1974, 1788, 2127, 2414, 2118, 1794, 1945, 2250, 2148, 1821, 1867, 2127, 2143, 1890, 1880, 2153, 2116, 1893, 1964, 2221, 2216, 2046, 1916, 2091, 2225, 2088, 2067, 2099, 2001, 1947, 2137, 2239, 2037, 1893, 2143, 2283, 1988, 1753, 1956, 2334, 2301, 1983, 1737, 2069, 2321, 2143, 2088, 2093, 2117, 2358, 2228, 1753, 1836, 2201, 2200, 2255, 1908, 1749, 1975, 1972, 2313, 1994, 1718, 1816, 2189, 2298, 2060, 1992, 1944, 2084, 2255, 2142, 1810, 1634, 1821, 2075, 1915, 1725, 1735, 1851, 1922, 1966, 1889, 1832, 1926, 2201, 2352, 2433, 2333, 2320, 2362, 2268, 2127, 2035, 2185, 2342, 2117, 1649, 1453, 1725, 2197, 2294, 2074, 1993, 2150, 2330, 2269, 2117, 2019, 2078, 2110, 1990, 1883, 2084, 2389, 2321, 1887, 1693, 2054, 2429, 2257, 1885, 1768, 2103, 2369, 2154, 1815, 1904, 2322, 2325, 1853, 1796];
% Q=[2067, 2100, 2081, 2031, 2064, 2106, 2097, 2055, 2084, 2121, 2078, 2036, 2005, 2049, 2043, 1984, 2063, 2131, 2109, 2046, 2067, 2062, 2144, 2166, 2102, 2043, 2022, 2076, 2162, 2096, 1994, 2013, 2086, 2116, 2036, 1964, 2036, 2158, 2168, 2053, 1962, 2025, 2113, 2152, 2103, 1983, 1942, 2036, 2130, 2086, 1939, 1885, 2020, 2141, 2091, 1960, 1949, 2103, 2234, 2134, 1909, 1830, 2010, 2194, 2153, 2051, 2037, 2129, 2154, 2074, 1994, 2029, 2162, 2153, 1996, 1908, 2035, 2183, 2190, 2036, 1933, 2015, 2133, 2150, 1966, 1985, 2061, 2159, 2127, 2011, 2011, 2130, 2118, 1977, 1893, 2074, 2174, 2075, 1954, 2026, 2167, 2086, 1944, 1957, 2097, 2107, 1992, 1963, 2097, 2142, 2017, 1924, 2056, 2127, 2040, 1951, 2040, 2102, 2052, 1992, 2007, 2074, 2072, 2036, 2068, 2058, 2020, 2096, 2112, 2045, 1965, 2044, 2059, 2007, 1975, 2009, 2104, 2101, 2007, 1944, 2019, 2048, 1945, 1921, 2014, 2107, 2205, 2164, 1886, 1930, 2275, 2225, 1912, 1889, 1995, 2149, 2197, 2063, 1922, 1998, 2148, 2122, 2002, 1974, 2051, 2240, 2246, 1985, 1895, 2071, 2200, 2121, 1983, 1866, 1979, 2116, 2228, 2137, 1994, 2030, 2175, 2131, 1900, 1724, 1824, 2003, 2148, 2157, 2026, 1969, 2066, 2190, 2174, 2075, 1984, 2089, 2209, 2253, 2174, 2036, 2010, 2082, 2041, 1963, 1922, 1979, 2106, 2079, 1959, 1878, 2090, 2268, 2223, 2058, 1971, 2050, 2173, 2059, 1984, 1975, 2153, 2209, 2099, 1940, 1957, 2096, 2161, 2089, 1982, 1989, 2144, 2182, 2033, 1943, 2074, 2214, 2168, 1983, 1976, 2147, 2184, 2026, 1933, 2056, 2190, 2089, 1936, 2017, 2155, 2104, 1956, 1954, 2110, 2067, 1921, 1984, 2176, 2138, 1952, 2003, 2218, 2139, 1945, 1981, 2175, 2086, 1911, 2037, 2213, 2079, 1928, 2109, 2253, 2031, 1855, 1932, 2191, 2284, 2046, 1808, 2077, 2427, 2065, 1729, 1900, 2095, 2186, 2071, 1755, 1743, 2121, 2241, 2188, 1931, 1804, 2182, 2255, 2090, 1942, 1853, 2002, 2155, 2087, 1977, 1954, 2027, 2084, 2054, 2001, 2056, 2087, 2135, 2038, 1886, 1835, 1747, 1839, 2086, 2294, 2367, 2350, 2358, 2357, 2255, 2162, 1997, 1977, 2108, 2174, 2127, 1986, 1910, 1917, 2001, 2149, 2165, 1972, 1881, 2018, 2088, 1937, 1819, 1918, 2081, 2079, 1942, 1847, 1988, 2055, 2018, 2002, 2007, 1992, 1891, 1911, 1989, 2075, 1995, 1885, 1989, 2084, 2087, 1962, 1949, 2086, 2213, 2092, 1898, 1990, 2261, 2234, 1962, 1903, 2182, 2247, 1992, 1866, 2121, 2282, 2006, 1847, 2139, 2276, 1982, 1855, 2152, 2258, 1936, 1911, 2228, 2216, 1940, 2006, 2159, 2008, 2008, 2139, 2096, 1977, 1937, 2028, 2102, 2114, 2124, 2067, 1978, 1996, 2057, 2018, 1974, 2015, 2022, 2233, 2289, 1990, 1967, 2065, 2025, 2125, 2237, 1795, 1882, 2356, 2137, 2011, 1775, 1699, 2288, 2319, 2107, 2003, 1585, 1932, 2344, 2184, 1882, 1654, 1919, 2390, 2352, 2006, 1734, 1735, 2060, 2137, 1705, 1559, 1865, 2423, 2705, 2378, 2064, 2079, 2209, 2320, 2228, 2056, 1922, 1867, 1901, 1954, 2033, 1962, 1817, 1756, 2001, 2278, 2202, 1792, 1640, 1879, 2249, 2361, 2112, 1838, 1934, 2311, 2471, 2233, 1851, 1984, 2337, 2449, 2089, 1880, 2111, 2434, 2376, 1975, 1913, 2268, 2521, 2199, 1778, 1930, 2387, 2477, 1983, 1663, 2114, 2556, 2344, 1744, 1713, 2260, 2473, 2000, 1685, 2033, 2392, 2069, 1661, 1879, 2334, 2279, 1865, 1854, 2238, 2336, 1998, 1918, 2207, 2290, 1973, 1934, 2198, 2189, 1907, 1817, 2011, 2190, 2047, 1890, 2022, 2037, 1967, 2054, 2195, 2024, 1852, 2021, 2256, 1992, 1711, 1981, 2426, 2356, 1858, 1745, 2067, 2418, 2141, 1801, 1968, 2060, 2038, 2086, 1708, 1663, 2288, 2451, 1967, 1854, 1687, 1964, 2365, 2183, 2242, 1729, 1935, 2466, 2368, 1932, 1803, 2041, 2149, 2125, 2062, 1896, 1830, 2247, 2528, 2408, 2065, 2127, 2416, 2456, 2356, 2268, 2159, 2248, 2338, 2343, 2103, 1840, 1664, 1768, 1779, 1706, 1742, 1898, 2084, 1921, 1661, 1759, 2274, 2735, 2622, 2017, 1776, 1962, 2180, 2058, 1768, 1731, 1890, 2072, 2035, 1964, 2134, 2296, 2126, 1726, 1651, 2127, 2490, 2191, 1642, 1668, 2125, 2361, 2103, 1679, 1820, 2284, 2327, 1792, 1661, 2152, 2394];

% I=[2028, 2002, 2040, 2068, 2045, 1988, 1999, 2000, 2023, 2009, 2029, 2072, 2057, 2048, 2076, 2131, 2064, 2010, 2042, 2061, 2069, 2074, 2026, 2028, 2077, 2086, 2082, 2030, 2010, 2062, 2117, 2060, 2016, 1992, 2063, 2121, 2069, 1966, 1975, 2099, 2150, 2082, 1992, 2000, 2065, 2146, 2089, 2015, 1980, 2087, 2157, 2125, 2022, 1980, 2030, 2128, 2128, 1981, 1933, 2071, 2245, 2214, 2043, 1950];
% Q=[2067, 2100, 2081, 2031, 2064, 2106, 2097, 2055, 2084, 2121, 2078, 2036, 2005, 2049, 2043, 1984, 2063, 2131, 2109, 2046, 2067, 2062, 2144, 2166, 2102, 2043, 2022, 2076, 2162, 2096, 1994, 2013, 2086, 2116, 2036, 1964, 2036, 2158, 2168, 2053, 1962, 2025, 2113, 2152, 2103, 1983, 1942, 2036, 2130, 2086, 1939, 1885, 2020, 2141, 2091, 1960, 1949, 2103, 2234, 2134, 1909, 1830, 2010, 2194];

% I=I';
% Q=Q';
% classLabel='caonm';
% ifScaled=0;
% featureClass = 0;

%% Test from cut file
%     fileName
% cut the data shorted to store in C# code for dummy data testing
%     N = 64*10;
%     offset = 256*0;
%     I = I(offset+(1:N));
%     Q = Q(offset+(1:N));
%     GenerateArrInCsharp(I);
%     pause;
%     GenerateArrInCsharp(Q);
%
%%


%%%%%%%%%%%%%%%%%%%%%%%% DC Tracking %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% nBuffer = floor(N/128);
% nLeft = N-nBuffer*128;
% I_median = ones(128,1)*median(I(1:128));
% Q_median = ones(128,1)*median(Q(1:128));
% for i=2:nBuffer
%     I_median=[I_median;ones(128,1)*median(I(128*(i-2)+1:128*(i-2)+128))];
%     Q_median=[Q_median;ones(128,1)*median(Q(128*(i-2)+1:128*(i-2)+128))];
% end
% I_median=[I_median;ones(nLeft,1)*median(I(128*(nBuffer-1)+1:128*(nBuffer-1)+128))];
% Q_median=[Q_median;ones(nLeft,1)*median(Q(128*(nBuffer-1)+1:128*(nBuffer-1)+128))];
%
% Data = (I-I_median) + 1i*(Q-Q_median);

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Data = (I-mean(I)) + 1i*(Q-mean(Q));

dcI = 2044;   % enable when do test on dummy data
dcQ = 2048;

% dcI = median(I);
% dcQ = median(Q);
Data = (I-dcI) + 1i*(Q-dcQ);




Rate=256;
FftWindow = Rate;
FftStep = round(1/4*FftWindow);

Freq = FftFreq(FftWindow, Rate);


medianBack=[];
stdBack=[];


%     if length(strfind(fileName,'\'))==0
%         BkFileName = ['..\bk\',fileName(1:strfind(fileName,'cut')-2),'_bk'];
%     else BkFileName = ['..\bk\',fileName(strfind(fileName,'\')+1:strfind(fileName,'cut')-2),'_bk'];
%     end
%     [I,Q,N]=Data2IQ(ReadBin([BkFileName,'.data']));
%     BkData=I+1i*Q;
%     [medianBack,stdBack] = ComputeBack(BkData, FftWindow, FftStep);



%     Img = AnomImage(Data, FftWindow, FftStep, Rate, meanBack+3*stdBack);
%    Img = AnomImage(Data, FftWindow, FftStep, Rate, thr_sqr_matlab,medianBack,stdBack);
%Img_adaptive = AnomImageAdaptive(Data, FftWindow, FftStep, Rate, 0.7);

% %%%%%%%%%%%%%%%%%%%% Features Extraction %%%%%%%%%%%%%%%%%%%%%%%%%%%%
f=[];
if featureClass==1
    for VelWindow = [1 2 3 4 5]   % 1 is good
        for step = [0.25 0.5 1];
            VelOverlap = 1- step/VelWindow;
            
            for quantile = [0.9 0.7 0.5 0.1]
                f = [f SlidingPercentileVelocity(Data,VelWindow,VelOverlap,Rate, quantile)];
            end
        end
    end
end

if featureClass==2
    for VelWindow = [1 2 3 4 5]   % 1 is good
        for step = [0.25 0.5 1];
            VelOverlap = 1- step/VelWindow;
            for quantile = [0.9 0.7 0.5 0.1]
                f = [f ApproxMax(Data,VelWindow,VelOverlap,Rate, quantile)];
            end
        end
    end
end

if featureClass==3
    [dist, time, distTimeProd, distTimeRatio] = DistTime(Data);
    f = [dist time distTimeProd distTimeRatio];
end

if featureClass==4
    [fft_moment, fft_freq] = AboveBgndFft(Data,BkData,FftWindow,FftStep,Rate);
    f = [fft_moment fft_freq];
end

if featureClass==5
    [numHitBins_sum, numHitBins_var, moment_sum, moment_var] = SpectStat(Img, Freq);
    f = [f, numHitBins_sum, numHitBins_var, moment_sum, moment_var];
end

if featureClass==6
    maxFreq = MaxFreqMeas(Img, Freq,0.9,5);
    f= maxFreq;
end

if featureClass==7
    freqWidth = FreqWidthMeas(Img,4,7);
    f = freqWidth;
end

if featureClass==8
    accRange = AccRange(Data,0.5,0.5,Rate,0.9);  %0.5,0.8
    f = accRange;
end


if featureClass==9
    veloVar = VeloVarMinMax(Data, 1, 0.75, Rate, 0.1,0.9); %0.5, 0.8
    f = veloVar;
end



%
if featureClass == 0
    %         nFeature = 18;
    FftWindow = Rate;
    FftStep = round(1/4*FftWindow);  % 1/8
    
    % Calculate velocity based features
    
    %         oldVel1 = SlidingPercentileVelocity(Data,1,0.75,Rate, 0.9);
    %         oldVel2 = SlidingPercentileVelocity(Data,1,0.75,Rate, 0.7);
    %         oldVel3 = SlidingPercentileVelocity(Data,1,0.75,Rate, 0.5);
    %
    %         newVel1 = ApproxMax(Data,0.5,0.5,Rate, 0.9);   % VelWindow,VelOverlap
    %         newVel2 = ApproxMax(Data,0.5,0.5,Rate, 0.7);
    %         newVel3 = ApproxMax(Data,0.5,0.5,Rate, 0.5);
    
    % Calculate phase based features
    [dist, time, distTimeProd, distTimeRatio] = DistTime(Data); %NOTE by Dhrubo: The time is in units of step (1/4th s)
    
    
    
    
    %         f = zeros(1,nFeature);
    f=[];
    
    f=[f,timeDomainFeatures(Data)]; %8
    
    %         for quantile = [1 0.7 0.5]%0.05:0.05:0.95    %0.9
    for quantile = [0.9 0.7 0.5]                   %3
        %f = [f,SlidingPercentileVelocity(Data,0.25,0,Rate,quantile)];
        f = [f,SlidingPercentileVelocity(Data,1,0.75,Rate,quantile)];
    end
    
    for quantile = [0.9 0.7 0.5]%0.05:0.05:0.95   %19   %3
        %f = [f, ApproxMax(Data,0.25,0,Rate,quantile)];
        f = [f, ApproxMax(Data,0.5,0.5,Rate,quantile)];
    end
    
    f=[f,dist,time,distTimeProd,distTimeRatio];    % 4
    
    freq_height = [];
    for thr_sqr_matlab_log = [14.144,17,18.915,20,24.144,25] % Dhrubo added 18.915 and 24.144 corresponding to thr_sqr_Csharp=30 and 100 respectively
     % for thr_sqr_matlab_log = 25 % 18.9154624932669 % TEST ONLY. TODO: Delete line
        thr_sqr_matlab = 10^(thr_sqr_matlab_log/10)*25238;
        %         for thr_sqr_Csharp =[30 100];%[9.9994,19.301,38.51,121.78]
        %             thr_sqr_matlab = thr_sqr_Csharp * 256^2;
        %         for thr_sqr_Csharp = [9.9994,19.301,38.51,121.78]
        %             thr_sqr_matlab = thr_sqr_Csharp * 256^2;
        
        totalPowerAboveThr = TotalPowerAboveThr(Data, FftWindow, FftStep, Rate, thr_sqr_matlab,medianBack,stdBack);
        Img = AnomImage(Data, FftWindow, FftStep, Rate, thr_sqr_matlab,medianBack,stdBack);
        %             if isempty(fftimage)==1
        %                 Img = AnomImage(Data, FftWindow, FftStep, Rate, thr_sqr_matlab,medianBack,stdBack);
        %             else
        %                 Img = AnomImage(Data, FftWindow, FftStep, Rate, thr_sqr_matlab,medianBack,stdBack);
        %             end
        
        [numHitBins_sum, numHitBins_max, moment_sum,numHitBins_median,numHitBins_var] = SpectStat(Img, Freq);
        %           [numHitBins_sum, numHitBins_max, moment_sum,numHitBins_median] = SpectStat(Img_adaptive, Freq);
        maxFreq = MaxFreqMeas(Img, Freq, 0.9,5);
        freqWidth = FreqWidthMeas(Img,4,7);
        freqHeight = FreqHeightMeas(Img,1,1); % added by neel
        freq_height = [freq_height,freqHeight];
        %widthLengthRatio1 = numHitBins_max/(time/64-8);
        widthLengthRatio1 = numHitBins_max/(time-8);
        %widthLengthRatio2 = numHitBins_median/(time/64-4);
        widthLengthRatio2 = numHitBins_median/(time-4);
        f = [f,numHitBins_sum,numHitBins_max,numHitBins_median,numHitBins_var,moment_sum,maxFreq,freqWidth,freqHeight,widthLengthRatio1,widthLengthRatio2, totalPowerAboveThr]; % 10
    end
    
    
    %plot(freq_height);
    
    nSteps = size(Img,1);
    
    
    accRange = AccRange(Data,0.5,0.5,Rate,0.9);  % 0.5,0.8
    %veloVar = VeloVarMinMax(Data,1,0.75, Rate, 0.1,0.9);   %0.5, 0.8
    veloVar = VeloVarMinMax(Data,12,4,Rate,0.1,0.9); %Using # of samples as input, instead of # of windows
     
    f=[f,accRange];
    f=[f,veloVar];
    %addpath('C:\Users\he\My Research\2014.10\Haar Features');
    f = [f, haar_feature(Data,5)];
    %         f = [f, haar_feature(Data,5)-haar_feature(BkData,levels)];
    
end






%%%%%%%%%%% scaling
if ifScaled==1
    %         load('..\tmp','feature_min','feature_max')
    f = (f-feature_min).*scalingFactors;
end

f_file=[num2cell(f),classLabel]; %Return the list of features for that file and the classlabel (Human/Dog/Ball etc.) as the last feature.

%     nStep = N/64
%
%     f(11)
%     f(12)
%     meanI=mean(I)
%     meanQ=mean(Q)



% for dummy data, generate them and copy to WriteDataToNor.cs
%     GenerateArrInCsharp(I)
%     pause;
%     GenerateArrInCsharp(Q)





